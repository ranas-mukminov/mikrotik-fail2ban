# Fail2Ban filter for MikroTik RouterOS generic login failures
#
# Matches failed login attempts from MikroTik logs sent to remote syslog
# Expected log format: "login failure for user USERNAME from IP via SERVICE"
#
# Author: ranas-mukminov
# Based on: soriel/mikrotik-fail2ban

[Definition]

# Match failed login attempts
# Example log: "login failure for user admin from 192.168.1.100 via ssh"
# Example log: "login failure for user test from 10.0.0.50 via winbox"
failregex = ^.*login failure for user .* from <HOST> via .*$

# Ignore successful logins
ignoreregex = ^.*logged in.*$
              ^.*authentication succeeded.*$

[Init]

# Maximum lines to buffer for multiline matches
maxlines = 1
