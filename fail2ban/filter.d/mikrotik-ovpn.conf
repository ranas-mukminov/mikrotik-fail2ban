# Fail2Ban filter for MikroTik RouterOS OpenVPN login failures
#
# Matches failed OpenVPN authentication attempts from MikroTik logs
# Expected log format: OpenVPN logs with "authentication failed" messages
#
# Author: ranas-mukminov
# Based on: soriel/mikrotik-fail2ban

[Definition]

# Match OpenVPN authentication failures
# Example log: "ovpn,info <192.168.1.100>: user 'testuser' authentication failed"
# Example log: "ovpn,error <10.0.0.50> authentication failed"
failregex = ^.*ovpn.*<\s*<HOST>\s*>.*authentication failed.*$
            ^.*openvpn.*<\s*<HOST>\s*>.*authentication failed.*$

# Ignore successful authentication
ignoreregex = ^.*authenticated.*$
              ^.*connected.*$
              ^.*logged in.*$

[Init]

# Maximum lines to buffer for multiline matches
maxlines = 1
